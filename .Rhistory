which(c(a$a0,a$beta[-1])==0)
c(a$a0,a$beta[-1])
s=2
X<-data.frame(response=as.factor(binary.or),
age=scale(dat$Age),
sex=as.factor(dat$SEX),
Ed=scale(dat$EDUC),
# blood.pres=dat$`Blood Pressure Systolic`-dat$`Blood Pressure Diastolic`,
bmi=bmi,
stroke=as.factor(stroke),
#              hyperten=as.factor(hyperten),
diab=as.factor(diab),
Waist=dat$WAIST/dat$HIP,
site=factor(dat$SITE,levels = c('LIMA','AREQUIPA','PUNO')),
apoe=apoe,
NAT=unlist(ancestry[,s+1]))
newx<-model.matrix(response~.,data=X)
cv.a<-cv.glmnet(x=newx,y=binary.or,family='binomial',alpha=1,type.measure = 'deviance')
a<-glmnet(x=newx,y=binary.or,family='binomial',lambda = cv.a$lambda.min,alpha=1)
which(c(a$a0,a$beta[-1])==0)
xx<-X[,-(which(c(a$a0,a$beta[-1])==0)-1)]
xx
simple.glm<-polr(response~.,data=X,family='binomial')
xx$response<-o.r
simple.glm<-polr(response~.,data=X)
simple.glm<-polr(response~.,data=Xxx)
simple.glm<-polr(response~.,data=xx)
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
xx<-X
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
#su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
s=3
X<-data.frame(response=as.factor(binary.or),
age=scale(dat$Age),
sex=as.factor(dat$SEX),
Ed=scale(dat$EDUC),
# blood.pres=dat$`Blood Pressure Systolic`-dat$`Blood Pressure Diastolic`,
bmi=bmi,
stroke=as.factor(stroke),
#              hyperten=as.factor(hyperten),
diab=as.factor(diab),
Waist=dat$WAIST/dat$HIP,
site=factor(dat$SITE,levels = c('LIMA','AREQUIPA','PUNO')),
apoe=apoe,
NAT=unlist(ancestry[,s+1]))
newx<-model.matrix(response~.,data=X)
cv.a<-cv.glmnet(x=newx,y=binary.or,family='binomial',alpha=1,type.measure = 'deviance')
a<-glmnet(x=newx,y=binary.or,family='binomial',lambda = cv.a$lambda.min,alpha=1)
length(which(c(a$a0,a$beta[-1])==0))=0
length(which(c(a$a0,a$beta[-1])==0))
?glmnet
all.table<-cbind(all.table,su$coefficients)
all.table<-data.frame(matrix(NA,13,0))
for(s in 1:3){
X<-data.frame(response=as.factor(binary.or),
age=scale(dat$Age),
sex=as.factor(dat$SEX),
Ed=scale(dat$EDUC),
# blood.pres=dat$`Blood Pressure Systolic`-dat$`Blood Pressure Diastolic`,
bmi=bmi,
stroke=as.factor(stroke),
#              hyperten=as.factor(hyperten),
diab=as.factor(diab),
Waist=dat$WAIST/dat$HIP,
site=factor(dat$SITE,levels = c('LIMA','AREQUIPA','PUNO')),
apoe=apoe,
NAT=unlist(ancestry[,s+1]))
newx<-model.matrix(response~.,data=X)
cv.a<-cv.glmnet(x=newx,y=binary.or,family='binomial',alpha=1,type.measure = 'deviance')
a<-glmnet(x=newx,y=binary.or,family='binomial',lambda = cv.a$lambda.min,alpha=1)
if(length(which(c(a$a0,a$beta[-1])==0))==0){
xx<-X
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}else{
xx<-X[,-(which(c(a$a0,a$beta[-1])==0)-1)]
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}
all.table<-cbind(all.table,su$coefficients)
}
su$coefficients
X<-data.frame(response=as.factor(binary.or),
age=scale(dat$Age),
sex=as.factor(dat$SEX),
Ed=scale(dat$EDUC),
# blood.pres=dat$`Blood Pressure Systolic`-dat$`Blood Pressure Diastolic`,
bmi=bmi,
stroke=as.factor(stroke),
#              hyperten=as.factor(hyperten),
diab=as.factor(diab),
Waist=dat$WAIST/dat$HIP,
site=factor(dat$SITE,levels = c('LIMA','AREQUIPA','PUNO')),
apoe=apoe,
NAT=unlist(ancestry[,s+1]))
newx<-model.matrix(response~.,data=X)
cv.a<-cv.glmnet(x=newx,y=binary.or,family='binomial',alpha=1,type.measure = 'deviance')
a<-glmnet(x=newx,y=binary.or,family='binomial',lambda = cv.a$lambda.min,alpha=1)
which(c(a$a0,a$beta[-1])==0)
X<-data.frame(response=as.factor(binary.or),
age=scale(dat$Age),
sex=as.factor(dat$SEX),
Ed=scale(dat$EDUC),
# blood.pres=dat$`Blood Pressure Systolic`-dat$`Blood Pressure Diastolic`,
bmi=bmi,
stroke=as.factor(stroke),
#              hyperten=as.factor(hyperten),
diab=as.factor(diab),
Waist=dat$WAIST/dat$HIP,
site=factor(dat$SITE,levels = c('LIMA','AREQUIPA','PUNO')),
apoe=apoe,
NAT=unlist(ancestry[,s+1]))
newx<-model.matrix(response~.,data=X)
cv.a<-cv.glmnet(x=newx,y=binary.or,family='binomial',alpha=.5,type.measure = 'deviance')
a<-glmnet(x=newx,y=binary.or,family='binomial',lambda = cv.a$lambda.min,alpha=0.5)
if(length(which(c(a$a0,a$beta[-1])==0))==0){
xx<-X
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}else{
xx<-X[,-(which(c(a$a0,a$beta[-1])==0)-1)]
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}
all.table<-data.frame(matrix(NA,13,0))
for(s in 1:3){
X<-data.frame(response=as.factor(binary.or),
age=scale(dat$Age),
sex=as.factor(dat$SEX),
Ed=scale(dat$EDUC),
# blood.pres=dat$`Blood Pressure Systolic`-dat$`Blood Pressure Diastolic`,
bmi=bmi,
stroke=as.factor(stroke),
#              hyperten=as.factor(hyperten),
diab=as.factor(diab),
Waist=dat$WAIST/dat$HIP,
site=factor(dat$SITE,levels = c('LIMA','AREQUIPA','PUNO')),
apoe=apoe,
NAT=unlist(ancestry[,s+1]))
newx<-model.matrix(response~.,data=X)
cv.a<-cv.glmnet(x=newx,y=binary.or,family='binomial',alpha=.5,type.measure = 'deviance')
a<-glmnet(x=newx,y=binary.or,family='binomial',lambda = cv.a$lambda.min,alpha=0.5)
if(length(which(c(a$a0,a$beta[-1])==0))==0){
xx<-X
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}else{
xx<-X[,-(which(c(a$a0,a$beta[-1])==0)-1)]
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}
all.table<-cbind(all.table,su$coefficients)
}
all.table
all.table<-list()
for(s in 1:3){
X<-data.frame(response=as.factor(binary.or),
age=scale(dat$Age),
sex=as.factor(dat$SEX),
Ed=scale(dat$EDUC),
# blood.pres=dat$`Blood Pressure Systolic`-dat$`Blood Pressure Diastolic`,
bmi=bmi,
stroke=as.factor(stroke),
#              hyperten=as.factor(hyperten),
diab=as.factor(diab),
Waist=dat$WAIST/dat$HIP,
site=factor(dat$SITE,levels = c('LIMA','AREQUIPA','PUNO')),
apoe=apoe,
NAT=unlist(ancestry[,s+1]))
newx<-model.matrix(response~.,data=X)
cv.a<-cv.glmnet(x=newx,y=binary.or,family='binomial',alpha=.5,type.measure = 'deviance')
a<-glmnet(x=newx,y=binary.or,family='binomial',lambda = cv.a$lambda.min,alpha=0.5)
if(length(which(c(a$a0,a$beta[-1])==0))==0){
xx<-X
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}else{
xx<-X[,-(which(c(a$a0,a$beta[-1])==0)-1)]
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}
all.table[[s]]<-su$coefficients
}
for(s in 1:3){
X<-data.frame(response=as.factor(binary.or),
age=scale(dat$Age),
sex=as.factor(dat$SEX),
Ed=scale(dat$EDUC),
# blood.pres=dat$`Blood Pressure Systolic`-dat$`Blood Pressure Diastolic`,
bmi=bmi,
stroke=as.factor(stroke),
#              hyperten=as.factor(hyperten),
diab=as.factor(diab),
Waist=dat$WAIST/dat$HIP,
site=factor(dat$SITE,levels = c('LIMA','AREQUIPA','PUNO')),
apoe=apoe,
NAT=unlist(ancestry[,s+1]))
newx<-model.matrix(response~.,data=X)
cv.a<-cv.glmnet(x=newx,y=binary.or,family='binomial',alpha=.5,type.measure = 'deviance')
a<-glmnet(x=newx,y=binary.or,family='binomial',lambda = cv.a$lambda.1se,alpha=0.5)
if(length(which(c(a$a0,a$beta[-1])==0))==0){
xx<-X
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}else{
xx<-X[,-(which(c(a$a0,a$beta[-1])==0)-1)]
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}
all.table[[s]]<-su$coefficients
}
for(s in 1:3){
X<-data.frame(response=as.factor(binary.or),
age=scale(dat$Age),
sex=as.factor(dat$SEX),
Ed=scale(dat$EDUC),
# blood.pres=dat$`Blood Pressure Systolic`-dat$`Blood Pressure Diastolic`,
bmi=bmi,
stroke=as.factor(stroke),
#              hyperten=as.factor(hyperten),
diab=as.factor(diab),
Waist=dat$WAIST/dat$HIP,
site=factor(dat$SITE,levels = c('LIMA','AREQUIPA','PUNO')),
apoe=apoe,
NAT=unlist(ancestry[,s+1]))
newx<-model.matrix(response~.,data=X)
cv.a<-cv.glmnet(x=newx,y=binary.or,family='binomial',alpha=.5,type.measure = 'deviance')
a<-glmnet(x=newx,y=binary.or,family='binomial',lambda = cv.a$lambda.min,alpha=0.5)
if(length(which(c(a$a0,a$beta[-1])==0))==0){
xx<-X
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}else{
xx<-X[,-(which(c(a$a0,a$beta[-1])==0)-1)]
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}
all.table[[s]]<-su$coefficients
}
all.table
cbind(all.table[[1]],
all.table[[2]])
rbind(all.table[[2]],rep(0,4))
cbind(all.table[[1]],
rbind(all.table[[2]],rep(0,4)),
all.table[[3]])
xtable(cbind(all.table[[1]],
rbind(all.table[[2]],rep(0,4)),
all.table[[3]]),display =c('f',rep( c(rep('f',3),'e'),3)))
all.table<-data.frame(matrix(NA,13,0))
all.table<-list()
for(s in 1:3){
X<-data.frame(response=as.factor(binary.or),
age=scale(dat$Age),
sex=as.factor(dat$SEX),
Ed=scale(dat$EDUC),
# blood.pres=dat$`Blood Pressure Systolic`-dat$`Blood Pressure Diastolic`,
bmi=bmi,
stroke=as.factor(stroke),
#              hyperten=as.factor(hyperten),
diab=as.factor(diab),
Waist=dat$WAIST/dat$HIP,
#     site=factor(dat$SITE,levels = c('LIMA','AREQUIPA','PUNO')),
apoe=apoe,
NAT=unlist(ancestry[,s+1]))
newx<-model.matrix(response~.,data=X)
cv.a<-cv.glmnet(x=newx,y=binary.or,family='binomial',alpha=.5,type.measure = 'deviance')
a<-glmnet(x=newx,y=binary.or,family='binomial',lambda = cv.a$lambda.min,alpha=0.5)
if(length(which(c(a$a0,a$beta[-1])==0))==0){
xx<-X
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}else{
xx<-X[,-(which(c(a$a0,a$beta[-1])==0)-1)]
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}
all.table[[s]]<-su$coefficients
}
xtable(cbind(all.table[[1]],
rbind(all.table[[2]],rep(0,4)),
all.table[[3]]),display =c('f',rep( c(rep('f',3),'e'),3)))
xtable(cbind(all.table[[1]],
rbind(all.table[[2])),
xtable(cbind(all.table[[1]],
rbind(all.table[[2]]),
all.table[[3]]),display =c('f',rep( c(rep('f',3),'e'),3)))
all.table
X<-data.frame(response=as.factor(binary.or),
age=scale(dat$Age),
sex=as.factor(dat$SEX),
Ed=scale(dat$EDUC),
# blood.pres=dat$`Blood Pressure Systolic`-dat$`Blood Pressure Diastolic`,
bmi=bmi,
stroke=as.factor(stroke),
#              hyperten=as.factor(hyperten),
diab=as.factor(diab),
Waist=dat$WAIST/dat$HIP,
#     site=factor(dat$SITE,levels = c('LIMA','AREQUIPA','PUNO')),
apoe=apoe,
NAT=unlist(ancestry[,s+1]))
newx<-model.matrix(response~.,data=X)
cv.a<-cv.glmnet(x=newx,y=binary.or,family='binomial',alpha=.5,type.measure = 'deviance')
a<-glmnet(x=newx,y=binary.or,family='binomial',lambda = cv.a$lambda.min,alpha=0.5)
c(a$a0,a$beta[-1])==0)
c(a$a0,a$beta[-1])==0))
all.table<-data.frame(matrix(NA,13,0))
all.table<-list()
for(s in 1:3){
X<-data.frame(response=as.factor(binary.or),
age=scale(dat$Age),
sex=as.factor(dat$SEX),
Ed=scale(dat$EDUC),
# blood.pres=dat$`Blood Pressure Systolic`-dat$`Blood Pressure Diastolic`,
bmi=bmi,
stroke=as.factor(stroke),
#              hyperten=as.factor(hyperten),
diab=as.factor(diab),
Waist=dat$WAIST/dat$HIP,
#     site=factor(dat$SITE,levels = c('LIMA','AREQUIPA','PUNO')),
apoe=apoe,
NAT=unlist(ancestry[,s+1]))
newx<-model.matrix(response~.,data=X)
cv.a<-cv.glmnet(x=newx,y=binary.or,family='binomial',alpha=.5,type.measure = 'deviance')
a<-glmnet(x=newx,y=binary.or,family='binomial',lambda = cv.a$lambda.min,alpha=0.5)
if(length(which(c(a$a0,a$beta[-1])==0))==0){
xx<-X
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}else{
xx<-X[,-(which(c(a$a0,a$beta[-1])==0))]
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}
all.table[[s]]<-su$coefficients
}
(which(c(a$a0,a$beta[-1])==0))
c(a$a0,a$beta[-1])
all.table<-data.frame(matrix(NA,11,0))
(which(c(a$a0,a$beta[-1])==0)
(which(c(a$a0,a$beta[-1])==0))
(which(c(a$a0,a$beta[-1])==0))
all.table[,((s-1)*4+1):((s-1)*4+4)] <-su$coefficients
s=1
X<-data.frame(response=as.factor(binary.or),
age=scale(dat$Age),
sex=as.factor(dat$SEX),
Ed=scale(dat$EDUC),
# blood.pres=dat$`Blood Pressure Systolic`-dat$`Blood Pressure Diastolic`,
bmi=bmi,
stroke=as.factor(stroke),
#              hyperten=as.factor(hyperten),
diab=as.factor(diab),
Waist=dat$WAIST/dat$HIP,
#     site=factor(dat$SITE,levels = c('LIMA','AREQUIPA','PUNO')),
apoe=apoe,
NAT=unlist(ancestry[,s+1]))
newx<-model.matrix(response~.,data=X)
cv.a<-cv.glmnet(x=newx,y=binary.or,family='binomial',alpha=.5,type.measure = 'deviance')
a<-glmnet(x=newx,y=binary.or,family='binomial',lambda = cv.a$lambda.min,alpha=0.5)
which(c(a$a0,a$beta[-1])==0)
-(which(c(a$a0,a$beta[-1])==0))
all.table[-(which(c(a$a0,a$beta[-1])==0)),((s-1)*4+1):((s-1)*4+4)] <-su$coefficients
xx<-X[,-(which(c(a$a0,a$beta[-1])==0))]
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
all.table[-(which(c(a$a0,a$beta[-1])==0)),((s-1)*4+1):((s-1)*4+4)] <-su$coefficients
all.table
all.table<-data.frame(matrix(NA,11,12))
for(s in 1:3){
X<-data.frame(response=as.factor(binary.or),
age=scale(dat$Age),
sex=as.factor(dat$SEX),
Ed=scale(dat$EDUC),
# blood.pres=dat$`Blood Pressure Systolic`-dat$`Blood Pressure Diastolic`,
bmi=bmi,
stroke=as.factor(stroke),
#              hyperten=as.factor(hyperten),
diab=as.factor(diab),
Waist=dat$WAIST/dat$HIP,
#     site=factor(dat$SITE,levels = c('LIMA','AREQUIPA','PUNO')),
apoe=apoe,
NAT=unlist(ancestry[,s+1]))
newx<-model.matrix(response~.,data=X)
cv.a<-cv.glmnet(x=newx,y=binary.or,family='binomial',alpha=.5,type.measure = 'deviance')
a<-glmnet(x=newx,y=binary.or,family='binomial',lambda = cv.a$lambda.min,alpha=0.5)
if(length(which(c(a$a0,a$beta[-1])==0))==0){
xx<-X
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
}else{
xx<-X[,-(which(c(a$a0,a$beta[-1])==0))]
xx$response<-as.factor(o.r)
simple.glm<-polr(response~.,data=xx)
su<-summary(simple.glm)
su$coefficients<-cbind(su$coefficients,'p value'=(1-pnorm(abs(su$coefficients[,3])))*2)
# temp.t<-su$coefficients
colnames(su$coefficients)<-c('Est.','Std.','t','p')
print(xtable(su$coefficients))
all.table[-(which(c(a$a0,a$beta[-1])==0)),((s-1)*4+1):((s-1)*4+4)] <-su$coefficients
}
}
all.table
((s-1)*4+1):((s-1)*4+4)
xtable(all.table,display =c('f',rep( c(rep('f',3),'e'),3)))
all.table
rownames(all.table)[-(which(c(a$a0,a$beta[-1])==0))]<-rownames(su$coefficients)
xtable(all.table,display =c('f',rep( c(rep('f',3),'e'),3)))
